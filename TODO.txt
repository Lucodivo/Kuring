TODOs:
- Refactoring to vectors where they may be nicer to deal with than simple arrays